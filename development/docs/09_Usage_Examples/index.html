

<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/hf-tle92466ed-driver/development/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/hf-tle92466ed-driver/development/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  

    .site-nav > ul.nav-list:first-child > li > a,
    .site-nav > ul.nav-list:first-child > li > ul > li > a,
    
    .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(9)) > a,
    .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > ul > li a {
      background-image: none;
    }

    .site-nav > ul.nav-list:not(:first-child) a,
    .site-nav li.external a {
      background-image: none;
    }

    .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > ul > li:nth-child(9) > a {
      font-weight: 600;
      text-decoration: none;
    }.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg,
    .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > button svg,
    .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > ul > li:nth-child(9) > button svg {
      transform: rotate(-90deg);
    }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list,
    .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list,
    .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(9) > ul.nav-list {
      display: block;
    }
  </style>

  

  
    <script src="/hf-tle92466ed-driver/development/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/hf-tle92466ed-driver/development/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>üíª Usage Examples | HardFOC TLE92466ED Driver - development</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="üíª Usage Examples" />
<meta name="author" content="N3b3x" />
<meta property="og:locale" content="en" />
<meta name="description" content="Practical implementation examples and code samples for common use cases" />
<meta property="og:description" content="Practical implementation examples and code samples for common use cases" />
<link rel="canonical" href="https://n3b3x.github.io/hf-tle92466ed-driver/development/docs/09_Usage_Examples/" />
<meta property="og:url" content="https://n3b3x.github.io/hf-tle92466ed-driver/development/docs/09_Usage_Examples/" />
<meta property="og:site_name" content="HardFOC TLE92466ED Driver - development" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="üíª Usage Examples" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"N3b3x","url":"https://github.com/n3b3x"},"description":"Practical implementation examples and code samples for common use cases","headline":"üíª Usage Examples","url":"https://n3b3x.github.io/hf-tle92466ed-driver/development/docs/09_Usage_Examples/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- =============================================================================
     Custom Head Content for HardFOC Driver Documentation
     =============================================================================
     This file is included in the <head> section of every page.
     It loads custom CSS and JavaScript for enhanced functionality.
     ============================================================================= -->

<!-- Custom CSS for enhanced styling and fixes -->
<link rel="stylesheet" href="/hf-tle92466ed-driver/development/assets/css/custom.css">

<!-- Custom JavaScript for interactive features -->
<script src="/hf-tle92466ed-driver/development/assets/js/custom.js" defer></script>



</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  
    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/hf-tle92466ed-driver/development/" class="site-title lh-tight">
  HardFOC TLE92466ED Driver - development

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in üîß HardFOC TLE92466ED Driver category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/hf-tle92466ed-driver/development/" class="nav-list-link">üîß HardFOC TLE92466ED Driver</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in üìö Documentation category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/hf-tle92466ed-driver/development/docs/" class="nav-list-link">üìö Documentation</a><ul class="nav-list"><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/01_IC_Overview/" class="nav-list-link">üîå IC Overview</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/02_SPI_Protocol/" class="nav-list-link">üì° SPI Protocol</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/03_Register_Map/" class="nav-list-link">üìã Register Map</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/04_Current_Control/" class="nav-list-link">‚ö° Current Control</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/05_Channel_Modes/" class="nav-list-link">üéõÔ∏è Channel Modes</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/06_Diagnostics/" class="nav-list-link">üõ°Ô∏è Diagnostics</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/07_Driver_API/" class="nav-list-link">üîß Driver API</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/08_HAL_Implementation/" class="nav-list-link">üîå HAL Implementation</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/09_Usage_Examples/" class="nav-list-link">üíª Usage Examples</a></li></ul></li></ul></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/examples/esp32/docs/README_DRIVER_INTEGRATION_TEST.html" class="nav-list-link">Driver Integration Test Suite - TLE92466ED ESP32-C6</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/examples/esp32/docs/README_CONFIGURATION.html" class="nav-list-link">ESP32 Examples Configuration Guide</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/examples/esp32/docs/README_SOLENOID_CONTROL_TEST.html" class="nav-list-link">Solenoid Control Test - TLE92466ED ESP32-C6</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/examples/esp32/components/hf_tle92466ed/" class="nav-list-link">TLE92466ED ESP-IDF Component</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/examples/esp32/docs/" class="nav-list-link">TLE92466ED ESP32 Examples Documentation</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/examples/esp32/" class="nav-list-link">TLE92466ED ESP32-C6 Examples</a></li><li class="nav-list-item"><a href="/hf-tle92466ed-driver/development/examples/esp32/docs/README_TEST_FRAMEWORK.html" class="nav-list-link">TLE92466ED Test Framework Documentation</a></li></ul>
  
</nav>




  
  
    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  
</div>

  
  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search HardFOC TLE92466ED Driver - development" aria-label="Search HardFOC TLE92466ED Driver - development" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
    <nav aria-label="Auxiliary" class="aux-nav">
  <ul class="aux-nav-list">
    
      <li class="aux-nav-list-item">
        <a href="/hf-tle92466ed-driver/development/api/index.html" class="site-button"
          
        >
          üìñ API Reference
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/n3b3x/hf-tle92466ed-driver" class="site-button"
          
        >
          üìö GitHub Repository
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/n3b3x/hf-tle92466ed-driver/issues" class="site-button"
          
        >
          üêõ Report Issues
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/n3b3x/hf-tle92466ed-driver/stargazers" class="site-button"
          
        >
          ‚≠ê Star on GitHub
        </a>
      </li>
    
  </ul>
</nav>

  
</div>

    <div class="main-content-wrap">
      <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
    <li class="breadcrumb-nav-list-item"><a href="/hf-tle92466ed-driver/development/">üîß HardFOC TLE92466ED Driver</a></li>
    <li class="breadcrumb-nav-list-item"><a href="/hf-tle92466ed-driver/development/docs/">üìö Documentation</a></li>
    <li class="breadcrumb-nav-list-item"><span>üíª Usage Examples</span></li>
  </ol>
</nav>


      <div id="main-content" class="main-content">
        <main>
          
            <h1 id="usage-examples">
  
  
    <a href="#usage-examples" class="anchor-heading" aria-labelledby="usage-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Usage Examples
  
  
</h1>
    
<h2 id="complete-application-examples">
  
  
    <a href="#complete-application-examples" class="anchor-heading" aria-labelledby="complete-application-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Complete Application Examples
  
  
</h2>
    

<p>This document provides practical, ready-to-use code examples for common TLE92466ED applications.</p>
<h2 id="example-1-basic-current-control">
  
  
    <a href="#example-1-basic-current-control" class="anchor-heading" aria-labelledby="example-1-basic-current-control"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 1: Basic Current Control
  
  
</h2>
    
<h3 id="single-channel-icc-mode">
  
  
    <a href="#single-channel-icc-mode" class="anchor-heading" aria-labelledby="single-channel-icc-mode"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Single Channel ICC Mode
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">"TLE92466ED.hpp"</span><span class="cp">
#include</span> <span class="cpf">"my_platform_hal.hpp"</span><span class="cp">
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">TLE92466ED</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// 1. Create HAL and driver</span>
    <span class="n">MyPlatformHAL</span> <span class="n">hal</span><span class="p">;</span>
    <span class="n">Driver</span> <span class="n">driver</span><span class="p">(</span><span class="n">hal</span><span class="p">);</span>
    
    <span class="c1">// 2. Initialize</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">auto</span> <span class="n">result</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">init</span><span class="p">();</span> <span class="o">!</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">error</span><span class="p">(</span><span class="s">"Init failed"</span><span class="p">);</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c1">// 3. Configure channel (in Config Mode by default)</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">set_channel_mode</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">,</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">);</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">set_current_setpoint</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">,</span> <span class="mi">1500</span><span class="p">);</span> <span class="c1">// 1.5A</span>
    
    <span class="c1">// 4. Enter Mission Mode</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">enter_mission_mode</span><span class="p">();</span>
    
    <span class="c1">// 5. Enable channel</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    
    <span class="c1">// 6. Monitor</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">running</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">auto</span> <span class="n">current</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">get_average_current</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">current</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">(</span><span class="s">"Current: %d mA"</span><span class="p">,</span> <span class="o">*</span><span class="n">current</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="n">delay</span><span class="p">(</span><span class="mx">100ms</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">// 7. Cleanup</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">disable_all_channels</span><span class="p">();</span>
    
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="example-2-parallel-operation-high-current">
  
  
    <a href="#example-2-parallel-operation-high-current" class="anchor-heading" aria-labelledby="example-2-parallel-operation-high-current"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 2: Parallel Operation (High Current)
  
  
</h2>
    
<h3 id="4a-solenoid-control">
  
  
    <a href="#4a-solenoid-control" class="anchor-heading" aria-labelledby="4a-solenoid-control"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4A Solenoid Control
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">configure_high_current_solenoid</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Driver</span> <span class="n">driver</span><span class="p">(</span><span class="n">hal</span><span class="p">);</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
    
    <span class="c1">// Enter Config Mode</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">enter_config_mode</span><span class="p">();</span>
    
    <span class="c1">// Enable parallel operation CH0+CH3</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">set_parallel_operation</span><span class="p">(</span><span class="n">ParallelPair</span><span class="o">::</span><span class="n">CH0_CH3</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    
    <span class="c1">// Configure both channels identically</span>
    <span class="n">ChannelConfig</span> <span class="n">config</span><span class="p">{</span>
        <span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">,</span>
        <span class="p">.</span><span class="n">current_setpoint_ma</span> <span class="o">=</span> <span class="mi">3500</span><span class="p">,</span>  <span class="c1">// 3.5A total</span>
        <span class="p">.</span><span class="n">slew_rate</span> <span class="o">=</span> <span class="n">SlewRate</span><span class="o">::</span><span class="n">MEDIUM_2V5_US</span><span class="p">,</span>
        <span class="p">.</span><span class="n">open_load_threshold</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1">// 4/8 = 50%</span>
    <span class="p">};</span>
    
    <span class="n">driver</span><span class="p">.</span><span class="n">configure_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">,</span> <span class="n">config</span><span class="p">);</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">configure_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH3</span><span class="p">,</span> <span class="n">config</span><span class="p">);</span>
    
    <span class="c1">// Enter Mission Mode and enable</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">enter_mission_mode</span><span class="p">();</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH3</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    
    <span class="n">log</span><span class="p">(</span><span class="s">"High-current mode active: 3.5A"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="example-3-proportional-valve-with-dither">
  
  
    <a href="#example-3-proportional-valve-with-dither" class="anchor-heading" aria-labelledby="example-3-proportional-valve-with-dither"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 3: Proportional Valve with Dither
  
  
</h2>
    
<h3 id="precision-position-control">
  
  
    <a href="#precision-position-control" class="anchor-heading" aria-labelledby="precision-position-control"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Precision Position Control
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">ProportionalValveController</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">ProportionalValveController</span><span class="p">(</span><span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver</span><span class="p">,</span> <span class="n">Channel</span> <span class="n">channel</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">driver_</span><span class="p">(</span><span class="n">driver</span><span class="p">),</span> <span class="n">channel_</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span> <span class="p">{}</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enter_config_mode</span><span class="p">();</span>
        
        <span class="c1">// Configure ICC mode</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">set_channel_mode</span><span class="p">(</span><span class="n">channel_</span><span class="p">,</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">);</span>
        
        <span class="c1">// Configure dither for smooth positioning</span>
        <span class="c1">// 100mA amplitude, 50Hz frequency</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">configure_dither</span><span class="p">(</span><span class="n">channel_</span><span class="p">,</span>
            <span class="mi">200</span><span class="p">,</span>   <span class="c1">// step_size (gives ~100mA amplitude)</span>
            <span class="mi">25</span><span class="p">,</span>    <span class="c1">// num_steps</span>
            <span class="mi">10</span><span class="p">);</span>   <span class="c1">// flat_steps</span>
        
        <span class="c1">// Set initial position (50% = 1000mA)</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">set_current_setpoint</span><span class="p">(</span><span class="n">channel_</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
        
        <span class="n">driver_</span><span class="p">.</span><span class="n">enter_mission_mode</span><span class="p">();</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">channel_</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">set_position</span><span class="p">(</span><span class="kt">float</span> <span class="n">percent</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Convert 0-100% to 0-2000mA</span>
        <span class="kt">uint16_t</span> <span class="n">current</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">uint16_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">percent</span> <span class="o">*</span> <span class="mf">20.0</span><span class="n">f</span><span class="p">);</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">set_current_setpoint</span><span class="p">(</span><span class="n">channel_</span><span class="p">,</span> <span class="n">current</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">float</span> <span class="n">get_actual_position</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">auto</span> <span class="n">current</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">get_average_current</span><span class="p">(</span><span class="n">channel_</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">current</span><span class="p">)</span> <span class="k">return</span> <span class="o">-</span><span class="mf">1.0</span><span class="n">f</span><span class="p">;</span>
        <span class="k">return</span> <span class="o">*</span><span class="n">current</span> <span class="o">/</span> <span class="mf">20.0</span><span class="n">f</span><span class="p">;</span>  <span class="c1">// Convert to %</span>
    <span class="p">}</span>
    
<span class="nl">private:</span>
    <span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver_</span><span class="p">;</span>
    <span class="n">Channel</span> <span class="n">channel_</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Usage</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">MyPlatformHAL</span> <span class="n">hal</span><span class="p">;</span>
    <span class="n">Driver</span> <span class="n">driver</span><span class="p">(</span><span class="n">hal</span><span class="p">);</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
    
    <span class="n">ProportionalValveController</span> <span class="n">valve</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">);</span>
    <span class="n">valve</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
    
    <span class="c1">// Ramp to 75% position</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">float</span> <span class="n">pos</span> <span class="o">=</span> <span class="mf">0.0</span><span class="n">f</span><span class="p">;</span> <span class="n">pos</span> <span class="o">&lt;=</span> <span class="mf">75.0</span><span class="n">f</span><span class="p">;</span> <span class="n">pos</span> <span class="o">+=</span> <span class="mf">1.0</span><span class="n">f</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">valve</span><span class="p">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mx">10ms</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="c1">// Monitor position</span>
    <span class="kt">float</span> <span class="n">actual</span> <span class="o">=</span> <span class="n">valve</span><span class="p">.</span><span class="n">get_actual_position</span><span class="p">();</span>
    <span class="n">log</span><span class="p">(</span><span class="s">"Position: %.1f%%"</span><span class="p">,</span> <span class="n">actual</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="example-4-multi-channel-solenoid-array">
  
  
    <a href="#example-4-multi-channel-solenoid-array" class="anchor-heading" aria-labelledby="example-4-multi-channel-solenoid-array"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 4: Multi-Channel Solenoid Array
  
  
</h2>
    
<h3 id="valve-bank-control">
  
  
    <a href="#valve-bank-control" class="anchor-heading" aria-labelledby="valve-bank-control"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Valve Bank Control
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">SolenoidArray</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">SolenoidArray</span><span class="p">(</span><span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver</span><span class="p">)</span> <span class="o">:</span> <span class="n">driver_</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span> <span class="p">{}</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enter_config_mode</span><span class="p">();</span>
        
        <span class="c1">// Configure all 6 channels</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Channel</span> <span class="n">ch</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            
            <span class="n">driver_</span><span class="p">.</span><span class="n">set_channel_mode</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">);</span>
            
            <span class="n">ChannelConfig</span> <span class="n">config</span><span class="p">{</span>
                <span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">,</span>
                <span class="p">.</span><span class="n">current_setpoint_ma</span> <span class="o">=</span> <span class="mi">1200</span><span class="p">,</span>  <span class="c1">// 1.2A per solenoid</span>
                <span class="p">.</span><span class="n">slew_rate</span> <span class="o">=</span> <span class="n">SlewRate</span><span class="o">::</span><span class="n">FAST_5V0_US</span><span class="p">,</span>
                <span class="p">.</span><span class="n">open_load_threshold</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="p">};</span>
            <span class="n">driver_</span><span class="p">.</span><span class="n">configure_channel</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">config</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="n">driver_</span><span class="p">.</span><span class="n">enter_mission_mode</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">activate_pattern</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">pattern</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Pattern is 6-bit mask for channels</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">enable</span> <span class="o">=</span> <span class="p">(</span><span class="n">pattern</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">enable</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">sequence_test</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Test each channel sequentially</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">(</span><span class="s">"Testing channel %d"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
            <span class="n">activate_pattern</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">);</span>
            <span class="n">delay</span><span class="p">(</span><span class="mx">500ms</span><span class="p">);</span>
            
            <span class="k">auto</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">get_channel_diagnostics</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">overcurrent</span><span class="p">)</span> <span class="n">log</span><span class="p">(</span><span class="s">"  OC fault!"</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">open_load</span><span class="p">)</span> <span class="n">log</span><span class="p">(</span><span class="s">"  Open load!"</span><span class="p">);</span>
                <span class="n">log</span><span class="p">(</span><span class="s">"  Current: %d mA"</span><span class="p">,</span> <span class="n">diag</span><span class="o">-&gt;</span><span class="n">average_current</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">activate_pattern</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>  <span class="c1">// All off</span>
    <span class="p">}</span>
    
<span class="nl">private:</span>
    <span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver_</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Usage</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">MyPlatformHAL</span> <span class="n">hal</span><span class="p">;</span>
    <span class="n">Driver</span> <span class="n">driver</span><span class="p">(</span><span class="n">hal</span><span class="p">);</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
    
    <span class="n">SolenoidArray</span> <span class="n">array</span><span class="p">(</span><span class="n">driver</span><span class="p">);</span>
    <span class="n">array</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
    
    <span class="c1">// Run sequence test</span>
    <span class="n">array</span><span class="p">.</span><span class="n">sequence_test</span><span class="p">();</span>
    
    <span class="c1">// Activate specific pattern</span>
    <span class="n">array</span><span class="p">.</span><span class="n">activate_pattern</span><span class="p">(</span><span class="mb">0b00101010</span><span class="p">);</span>  <span class="c1">// CH1, CH3, CH5</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="example-5-fault-tolerant-operation">
  
  
    <a href="#example-5-fault-tolerant-operation" class="anchor-heading" aria-labelledby="example-5-fault-tolerant-operation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 5: Fault-Tolerant Operation
  
  
</h2>
    
<h3 id="robust-error-handling">
  
  
    <a href="#robust-error-handling" class="anchor-heading" aria-labelledby="robust-error-handling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Robust Error Handling
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">FaultTolerantDriver</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="n">FaultTolerantDriver</span><span class="p">(</span><span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver</span><span class="p">)</span> <span class="o">:</span> <span class="n">driver_</span><span class="p">(</span><span class="n">driver</span><span class="p">),</span> <span class="n">fault_count_</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">{}</span>
    
    <span class="kt">bool</span> <span class="n">init_with_retry</span><span class="p">(</span><span class="kt">int</span> <span class="n">max_retries</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">attempt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">attempt</span> <span class="o">&lt;=</span> <span class="n">max_retries</span><span class="p">;</span> <span class="n">attempt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">(</span><span class="s">"Init attempt %d/%d"</span><span class="p">,</span> <span class="n">attempt</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">);</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="k">auto</span> <span class="n">result</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">init</span><span class="p">();</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">log</span><span class="p">(</span><span class="s">"Init successful"</span><span class="p">);</span>
                <span class="n">start_monitoring</span><span class="p">();</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">log</span><span class="p">(</span><span class="s">"Init failed: %d"</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">error</span><span class="p">()));</span>
                <span class="n">delay</span><span class="p">(</span><span class="mx">1s</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">log</span><span class="p">(</span><span class="s">"Init failed after %d attempts"</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">monitor_and_recover</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">auto</span> <span class="n">status</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">get_device_status</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
        
        <span class="c1">// Check for critical faults</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">ot_error</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">handle_overtemperature</span><span class="p">();</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">vbat_uv</span> <span class="o">||</span> <span class="n">status</span><span class="o">-&gt;</span><span class="n">vbat_ov</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">handle_supply_fault</span><span class="p">();</span>
        <span class="p">}</span>
        
        <span class="c1">// Check each channel</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Channel</span> <span class="n">ch</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="k">auto</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">get_channel_diagnostics</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">overcurrent</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">handle_overcurrent</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">short_to_ground</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">handle_short_circuit</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">open_load</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">handle_open_load</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
<span class="nl">private:</span>
    <span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver_</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">fault_count_</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">handle_overtemperature</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">log</span><span class="p">(</span><span class="s">"Over-temperature detected"</span><span class="p">);</span>
        
        <span class="c1">// Reduce all currents by 50%</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Channel</span> <span class="n">ch</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
            <span class="k">auto</span> <span class="n">current</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">get_current_setpoint</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">current</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">driver_</span><span class="p">.</span><span class="n">set_current_setpoint</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="o">*</span><span class="n">current</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1">// Clear fault after cooling</span>
        <span class="n">delay</span><span class="p">(</span><span class="mx">10s</span><span class="p">);</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">clear_faults</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">handle_overcurrent</span><span class="p">(</span><span class="n">Channel</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">log</span><span class="p">(</span><span class="s">"Over-current on channel %d"</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ch</span><span class="p">));</span>
        
        <span class="c1">// Disable channel</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
        
        <span class="c1">// Reduce setpoint</span>
        <span class="k">auto</span> <span class="n">current</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">get_current_setpoint</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">current</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">current</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">uint16_t</span> <span class="n">new_current</span> <span class="o">=</span> <span class="o">*</span><span class="n">current</span> <span class="o">-</span> <span class="mi">200</span><span class="p">;</span>  <span class="c1">// Reduce by 200mA</span>
            <span class="n">driver_</span><span class="p">.</span><span class="n">set_current_setpoint</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">new_current</span><span class="p">);</span>
        <span class="p">}</span>
        
        <span class="c1">// Clear fault and retry</span>
        <span class="n">delay</span><span class="p">(</span><span class="mx">100ms</span><span class="p">);</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">clear_faults</span><span class="p">();</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">handle_short_circuit</span><span class="p">(</span><span class="n">Channel</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">log</span><span class="p">(</span><span class="s">"Short circuit on channel %d"</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ch</span><span class="p">));</span>
        
        <span class="c1">// Permanent disable</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
        
        <span class="n">fault_count_</span><span class="o">++</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fault_count_</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">(</span><span class="s">"Too many faults, entering safe mode"</span><span class="p">);</span>
            <span class="n">driver_</span><span class="p">.</span><span class="n">disable_all_channels</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">handle_open_load</span><span class="p">(</span><span class="n">Channel</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">log</span><span class="p">(</span><span class="s">"Open load on channel %d"</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ch</span><span class="p">));</span>
        
        <span class="c1">// Check if transient</span>
        <span class="n">delay</span><span class="p">(</span><span class="mx">50ms</span><span class="p">);</span>
        <span class="k">auto</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">get_channel_diagnostics</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">diag</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">open_load</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">(</span><span class="s">"Transient open load, continuing"</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="c1">// Persistent open load - disable</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">handle_supply_fault</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">log</span><span class="p">(</span><span class="s">"Supply voltage fault"</span><span class="p">);</span>
        
        <span class="c1">// Enter safe state</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">disable_all_channels</span><span class="p">();</span>
        
        <span class="c1">// Wait for supply to stabilize</span>
        <span class="n">delay</span><span class="p">(</span><span class="mx">1s</span><span class="p">);</span>
        
        <span class="c1">// Re-enable if supply recovered</span>
        <span class="k">auto</span> <span class="n">status</span> <span class="o">=</span> <span class="n">driver_</span><span class="p">.</span><span class="n">get_device_status</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">vbat_uv</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">vbat_ov</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">log</span><span class="p">(</span><span class="s">"Supply recovered"</span><span class="p">);</span>
            <span class="n">driver_</span><span class="p">.</span><span class="n">clear_faults</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">start_monitoring</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Start periodic monitoring task</span>
        <span class="c1">// (platform-specific implementation)</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="example-6-automotive-application">
  
  
    <a href="#example-6-automotive-application" class="anchor-heading" aria-labelledby="example-6-automotive-application"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 6: Automotive Application
  
  
</h2>
    
<h3 id="engine-management-actuators">
  
  
    <a href="#engine-management-actuators" class="anchor-heading" aria-labelledby="engine-management-actuators"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Engine Management Actuators
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
</pre></td><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">EngineActuatorControl</span> <span class="p">{</span>
<span class="nl">public:</span>
    <span class="k">enum</span> <span class="k">class</span> <span class="nc">Actuator</span> <span class="p">{</span>
        <span class="n">VVT_INTAKE</span><span class="p">,</span>      <span class="c1">// Variable valve timing (CH0)</span>
        <span class="n">VVT_EXHAUST</span><span class="p">,</span>     <span class="c1">// Variable valve timing (CH1)</span>
        <span class="n">EGR_VALVE</span><span class="p">,</span>       <span class="c1">// EGR control (CH2)</span>
        <span class="n">WASTEGATE</span><span class="p">,</span>       <span class="c1">// Turbo wastegate (CH3)</span>
        <span class="n">FUEL_PUMP</span><span class="p">,</span>       <span class="c1">// High-pressure fuel pump (CH4+CH5 parallel)</span>
    <span class="p">};</span>
    
    <span class="n">EngineActuatorControl</span><span class="p">(</span><span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver</span><span class="p">)</span> <span class="o">:</span> <span class="n">driver_</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span> <span class="p">{}</span>
    
    <span class="kt">void</span> <span class="n">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enter_config_mode</span><span class="p">();</span>
        
        <span class="c1">// Configure VVT actuators (proportional, with dither)</span>
        <span class="n">configure_vvt</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">);</span>
        <span class="n">configure_vvt</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH1</span><span class="p">);</span>
        
        <span class="c1">// Configure EGR valve (proportional)</span>
        <span class="n">ChannelConfig</span> <span class="n">egr_config</span><span class="p">{</span>
            <span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">,</span>
            <span class="p">.</span><span class="n">current_setpoint_ma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1">// Start closed</span>
            <span class="p">.</span><span class="n">slew_rate</span> <span class="o">=</span> <span class="n">SlewRate</span><span class="o">::</span><span class="n">MEDIUM_2V5_US</span><span class="p">,</span>
            <span class="p">.</span><span class="n">open_load_threshold</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="p">};</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">configure_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH2</span><span class="p">,</span> <span class="n">egr_config</span><span class="p">);</span>
        
        <span class="c1">// Configure wastegate (fast response)</span>
        <span class="n">ChannelConfig</span> <span class="n">wg_config</span><span class="p">{</span>
            <span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">,</span>
            <span class="p">.</span><span class="n">current_setpoint_ma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="p">.</span><span class="n">slew_rate</span> <span class="o">=</span> <span class="n">SlewRate</span><span class="o">::</span><span class="n">FASTEST_10V0_US</span><span class="p">,</span>
            <span class="p">.</span><span class="n">open_load_threshold</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="p">};</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">configure_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH3</span><span class="p">,</span> <span class="n">wg_config</span><span class="p">);</span>
        
        <span class="c1">// Configure fuel pump (parallel, high current)</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">set_parallel_operation</span><span class="p">(</span><span class="n">ParallelPair</span><span class="o">::</span><span class="n">CH4_CH5</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
        <span class="n">ChannelConfig</span> <span class="n">pump_config</span><span class="p">{</span>
            <span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">,</span>
            <span class="p">.</span><span class="n">current_setpoint_ma</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span>  <span class="c1">// 3A</span>
            <span class="p">.</span><span class="n">slew_rate</span> <span class="o">=</span> <span class="n">SlewRate</span><span class="o">::</span><span class="n">MEDIUM_2V5_US</span><span class="p">,</span>
            <span class="p">.</span><span class="n">open_load_threshold</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="p">};</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">configure_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH4</span><span class="p">,</span> <span class="n">pump_config</span><span class="p">);</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">configure_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH5</span><span class="p">,</span> <span class="n">pump_config</span><span class="p">);</span>
        
        <span class="n">driver_</span><span class="p">.</span><span class="n">enter_mission_mode</span><span class="p">();</span>
        
        <span class="c1">// Enable critical actuators</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH4</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>  <span class="c1">// Fuel pump</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH5</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">set_vvt_position</span><span class="p">(</span><span class="n">Actuator</span> <span class="n">actuator</span><span class="p">,</span> <span class="kt">float</span> <span class="n">degrees</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Channel</span> <span class="n">ch</span> <span class="o">=</span> <span class="p">(</span><span class="n">actuator</span> <span class="o">==</span> <span class="n">Actuator</span><span class="o">::</span><span class="n">VVT_INTAKE</span><span class="p">)</span> <span class="o">?</span> <span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span> <span class="o">:</span> <span class="n">Channel</span><span class="o">::</span><span class="n">CH1</span><span class="p">;</span>
        
        <span class="c1">// Convert degrees to current (example: 0-50¬∞ = 500-1500mA)</span>
        <span class="kt">uint16_t</span> <span class="n">current</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">+</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">uint16_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">degrees</span> <span class="o">*</span> <span class="mf">20.0</span><span class="n">f</span><span class="p">);</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">set_current_setpoint</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">current</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kt">void</span> <span class="n">set_egr_opening</span><span class="p">(</span><span class="kt">float</span> <span class="n">percent</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 0-100% = 0-1800mA</span>
        <span class="kt">uint16_t</span> <span class="n">current</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">uint16_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">percent</span> <span class="o">*</span> <span class="mf">18.0</span><span class="n">f</span><span class="p">);</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">set_current_setpoint</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH2</span><span class="p">,</span> <span class="n">current</span><span class="p">);</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">percent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">driver_</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH2</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
<span class="nl">private:</span>
    <span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver_</span><span class="p">;</span>
    
    <span class="kt">void</span> <span class="n">configure_vvt</span><span class="p">(</span><span class="n">Channel</span> <span class="n">ch</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ChannelConfig</span> <span class="n">config</span><span class="p">{</span>
            <span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">ChannelMode</span><span class="o">::</span><span class="n">ICC</span><span class="p">,</span>
            <span class="p">.</span><span class="n">current_setpoint_ma</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>  <span class="c1">// Mid position</span>
            <span class="p">.</span><span class="n">slew_rate</span> <span class="o">=</span> <span class="n">SlewRate</span><span class="o">::</span><span class="n">MEDIUM_2V5_US</span><span class="p">,</span>
            <span class="p">.</span><span class="n">open_load_threshold</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
            <span class="p">.</span><span class="n">deep_dither_enabled</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span>
            <span class="p">.</span><span class="n">dither_step_size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="c1">// Small dither for positioning</span>
            <span class="p">.</span><span class="n">dither_steps</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="p">.</span><span class="n">dither_flat</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="p">};</span>
        <span class="n">driver_</span><span class="p">.</span><span class="n">configure_channel</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">config</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="example-7-diagnostic-dashboard">
  
  
    <a href="#example-7-diagnostic-dashboard" class="anchor-heading" aria-labelledby="example-7-diagnostic-dashboard"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example 7: Diagnostic Dashboard
  
  
</h2>
    
<h3 id="system-health-monitoring">
  
  
    <a href="#system-health-monitoring" class="anchor-heading" aria-labelledby="system-health-monitoring"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> System Health Monitoring
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">print_system_status</span><span class="p">(</span><span class="n">Driver</span><span class="o">&amp;</span> <span class="n">driver</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">=== TLE92466ED System Status ===</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    
    <span class="c1">// Global status</span>
    <span class="k">auto</span> <span class="n">status</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">get_device_status</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Mode: "</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">config_mode</span> <span class="o">?</span> <span class="s">"Config"</span> <span class="o">:</span> <span class="s">"Mission"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Init Done: "</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">init_done</span> <span class="o">?</span> <span class="s">"Yes"</span> <span class="o">:</span> <span class="s">"No"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Faults: "</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">any_fault</span> <span class="o">?</span> <span class="s">"YES"</span> <span class="o">:</span> <span class="s">"No"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">any_fault</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"  VBAT UV: "</span> <span class="o">&lt;&lt;</span> <span class="n">status</span><span class="o">-&gt;</span><span class="n">vbat_uv</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"  VBAT OV: "</span> <span class="o">&lt;&lt;</span> <span class="n">status</span><span class="o">-&gt;</span><span class="n">vbat_ov</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"  OT Warn: "</span> <span class="o">&lt;&lt;</span> <span class="n">status</span><span class="o">-&gt;</span><span class="n">ot_warning</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
            <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"  OT Error: "</span> <span class="o">&lt;&lt;</span> <span class="n">status</span><span class="o">-&gt;</span><span class="n">ot_error</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// Channel status</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">Channel Status:</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"CH | Setpt | Actual | DC%  | Faults</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"---+-------+--------+------+--------</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Channel</span> <span class="n">ch</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">Channel</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        
        <span class="k">auto</span> <span class="n">setpoint</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">get_current_setpoint</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
        <span class="k">auto</span> <span class="n">actual</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">get_average_current</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
        <span class="k">auto</span> <span class="n">dc</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">get_duty_cycle</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
        <span class="k">auto</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">get_channel_diagnostics</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
        
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">" "</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">" | "</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">setpoint</span> <span class="o">?</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="o">*</span><span class="n">setpoint</span><span class="p">)</span> <span class="o">:</span> <span class="s">"ERR"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" | "</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">actual</span> <span class="o">?</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="o">*</span><span class="n">actual</span><span class="p">)</span> <span class="o">:</span> <span class="s">"ERR"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" | "</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">dc</span> <span class="o">?</span> <span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="o">*</span><span class="n">dc</span> <span class="o">/</span> <span class="mi">655</span><span class="p">)</span> <span class="o">:</span> <span class="s">"ERR"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">" | "</span><span class="p">;</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">overcurrent</span><span class="p">)</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"OC "</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">short_to_ground</span><span class="p">)</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"SG "</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">diag</span><span class="o">-&gt;</span><span class="n">open_load</span><span class="p">)</span> <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"OL "</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"================================</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h2 id="practical-tips">
  
  
    <a href="#practical-tips" class="anchor-heading" aria-labelledby="practical-tips"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Practical Tips
  
  
</h2>
    
<h3 id="1-always-check-return-values">
  
  
    <a href="#1-always-check-return-values" class="anchor-heading" aria-labelledby="1-always-check-return-values"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Always Check Return Values
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c1">// Bad</span>
<span class="n">driver</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
<span class="n">driver</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>

<span class="c1">// Good</span>
<span class="k">if</span> <span class="p">(</span><span class="k">auto</span> <span class="n">result</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">init</span><span class="p">();</span> <span class="o">!</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">handle_error</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">error</span><span class="p">());</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h3 id="2-service-watchdogs">
  
  
    <a href="#2-service-watchdogs" class="anchor-heading" aria-labelledby="2-service-watchdogs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Service Watchdogs
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c1">// In main loop</span>
<span class="k">while</span> <span class="p">(</span><span class="n">running</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">reload_spi_watchdog</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
    <span class="c1">// ... other operations</span>
    <span class="n">delay</span><span class="p">(</span><span class="mx">50ms</span><span class="p">);</span>  <span class="c1">// Must be &lt; watchdog timeout</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h3 id="3-monitor-before-critical-operations">
  
  
    <a href="#3-monitor-before-critical-operations" class="anchor-heading" aria-labelledby="3-monitor-before-critical-operations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Monitor Before Critical Operations
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c1">// Before enabling high-current load</span>
<span class="k">auto</span> <span class="n">status</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">get_device_status</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">vbat_uv</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">status</span><span class="o">-&gt;</span><span class="n">ot_error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">enable_channel</span><span class="p">(</span><span class="n">Channel</span><span class="o">::</span><span class="n">CH0</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">log</span><span class="p">(</span><span class="s">"Cannot enable: system fault"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>
<h3 id="4-graceful-shutdown">
  
  
    <a href="#4-graceful-shutdown" class="anchor-heading" aria-labelledby="4-graceful-shutdown"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Graceful Shutdown
  
  
</h3>
    

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">shutdown</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Disable all outputs</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">disable_all_channels</span><span class="p">();</span>
    
    <span class="c1">// Return to safe state</span>
    <span class="n">driver</span><span class="p">.</span><span class="n">enter_config_mode</span><span class="p">();</span>
    
    <span class="c1">// Device is now safe</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></div></code></pre></div></div><hr />

<div class="table-wrapper"><table>
  <tbody>
    <tr>
      <td><strong>Navigation</strong>: <a href="/hf-tle92466ed-driver/development/docs/08_HAL_Implementation/">‚Üê HAL Implementation</a></td>
      <td><a href="/hf-tle92466ed-driver/development/docs/">Back to Index</a></td>
    </tr>
  </tbody>
</table></div>

          

          
            
          
        </main>
        

  <hr>
  <footer>
    

    <!-- =============================================================================
     Custom Footer Content for HardFOC Driver Documentation
     =============================================================================
     This footer is displayed at the bottom of every page.
     ============================================================================= -->

<footer class="site-footer">
  <div class="site-footer-credits">
    <p>Built with ‚ù§Ô∏è using <a href="https://just-the-docs.github.io/just-the-docs/">Just the Docs</a></p>
    <p>
      <a href="https://github.com/n3b3x/hf-tle92466ed-driver/development/blob/main/LICENSE">GPL v3 License</a> ‚Ä¢ 
      <a href="https://github.com/n3b3x/hf-tle92466ed-driver/development">View on GitHub</a>
    </p>
  </div>
</footer>



    
  </footer>


      </div>
    </div>
    
      
<button id="search-button" class="search-button btn-reset" aria-label="Focus on search">
  <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-search"></use></svg>
</button>


<div class="search-overlay"></div>

    
  </div>

  
</body>
</html>

